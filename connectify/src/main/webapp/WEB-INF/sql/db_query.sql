-- 분류체계 코드 테이블 (lclsSystmCode2 오퍼레이션 데이터 저장)
-- 분류체계 대, 중, 소분류 코드를 복합 기본 키로 사용
CREATE TABLE TOUR_CLASSIFICATION_SYSTEM_CODE (
	RNUM			NUMBER PRIMARY KEY,
    LCLS_SYSTM1_CD  VARCHAR2(10) NOT NULL,   -- 분류체계 대분류 코드 (예: 'AC' 숙박)
    LCLS_SYSTM1_NM  VARCHAR2(100) NOT NULL,  -- 분류체계 대분류명
    LCLS_SYSTM2_CD  VARCHAR2(10),            -- 분류체계 중분류 코드 (예: 'AC01' 호텔)
    LCLS_SYSTM2_NM  VARCHAR2(100),           -- 분류체계 중분류명
    LCLS_SYSTM3_CD  VARCHAR2(10),            -- 분류체계 소분류 코드 (예: 'AC010100' 호텔)
    LCLS_SYSTM3_NM  VARCHAR2(100),           -- 분류체계 소분류명
    CREATED_TIME    TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL,
    MODIFIED_TIME   TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL
);
COMMENT ON TABLE TOUR_CLASSIFICATION_SYSTEM_CODE IS '분류체계 코드 정보 테이블';
COMMENT ON COLUMN TOUR_CLASSIFICATION_SYSTEM_CODE.RNUM IS '일련번호';
COMMENT ON COLUMN TOUR_CLASSIFICATION_SYSTEM_CODE.LCLS_SYSTM1_CD IS '분류체계 대분류 코드';
COMMENT ON COLUMN TOUR_CLASSIFICATION_SYSTEM_CODE.LCLS_SYSTM1_NM IS '분류체계 대분류명';
COMMENT ON COLUMN TOUR_CLASSIFICATION_SYSTEM_CODE.LCLS_SYSTM2_CD IS '분류체계 중분류 코드';
COMMENT ON COLUMN TOUR_CLASSIFICATION_SYSTEM_CODE.LCLS_SYSTM2_NM IS '분류체계 중분류명';
COMMENT ON COLUMN TOUR_CLASSIFICATION_SYSTEM_CODE.LCLS_SYSTM3_CD IS '분류체계 소분류 코드';
COMMENT ON COLUMN TOUR_CLASSIFICATION_SYSTEM_CODE.LCLS_SYSTM3_NM IS '분류체계 소분류명';
COMMENT ON COLUMN TOUR_CLASSIFICATION_SYSTEM_CODE.CREATED_TIME IS '레코드 생성 시간';
COMMENT ON COLUMN TOUR_CLASSIFICATION_SYSTEM_CODE.MODIFIED_TIME IS '레코드 최종 수정 시간';

select * from ;


-- 관광 목적지 정보 테이블 (areaBasedList2 오퍼레이션 데이터 저장)
CREATE TABLE TOUR_DESTINATION (
    CONTENT_ID          NUMBER PRIMARY KEY,
    CONTENT_TYPE_ID     NUMBER NOT NULL,
    TITLE               VARCHAR2(500) NOT NULL,
    ADDR1               VARCHAR2(1000),
    ADDR2               VARCHAR2(1000),
    ZIPCODE             VARCHAR2(10),
    AREA_CODE           VARCHAR2(10),
    SIGUNGU_CODE        VARCHAR2(10),
    CAT1                VARCHAR2(10),
    CAT2                VARCHAR2(10),
    CAT3                VARCHAR2(10),
    MAPX                NUMBER(15, 10),
    MAPY                NUMBER(15, 10),
    MLEVEL				NUMBER(3),
    TEL                 VARCHAR2(100),    
    FIRST_IMAGE         VARCHAR2(2000),
    FIRST_IMAGE2        VARCHAR2(2000),
    CPYRHT_DIV_CD       VARCHAR2(10),
    LDONG_REGN_CD       VARCHAR2(5),    -- 법정동 시도 코드 
    LDONG_SIGNGU_CD     VARCHAR2(5),    -- 법정동 시군구 코드 
    LCLS_SYSTM1      VARCHAR2(10),   -- 분류체계 대분류 코드 
    LCLS_SYSTM2     VARCHAR2(10),   -- 분류체계 중분류 코드 
    LCLS_SYSTM3     VARCHAR2(10),   -- 분류체계 소분류 코드
    CREATED_TIME    VARCHAR2(40), -- API 응답의 createdtime (YYYYMMDDHHMMSS)
    MODIFIED_TIME  VARCHAR2(40) -- API 응답의 modifiedtime (YYYYMMDDHHMMSS)
);


COMMENT ON TABLE TOUR_DESTINATION IS '관광 목적지 정보 테이블';
COMMENT ON COLUMN TOUR_DESTINATION.CONTENT_ID IS '콘텐츠 ID';
COMMENT ON COLUMN TOUR_DESTINATION.CONTENT_TYPE_ID IS '관광타입 ID';
COMMENT ON COLUMN TOUR_DESTINATION.TITLE IS '콘텐츠 제목';
COMMENT ON COLUMN TOUR_DESTINATION.ADDR1 IS '주소';
COMMENT ON COLUMN TOUR_DESTINATION.ADDR2 IS '상세주소';
COMMENT ON COLUMN TOUR_DESTINATION.ZIPCODE IS '우편번호';
COMMENT ON COLUMN TOUR_DESTINATION.AREA_CODE IS '지역코드';
COMMENT ON COLUMN TOUR_DESTINATION.SIGUNGU_CODE IS '시군구코드';
COMMENT ON COLUMN TOUR_DESTINATION.CAT1 IS '대분류 코드';
COMMENT ON COLUMN TOUR_DESTINATION.CAT2 IS '중분류 코드';
COMMENT ON COLUMN TOUR_DESTINATION.CAT3 IS '소분류 코드';
COMMENT ON COLUMN TOUR_DESTINATION.MAPX IS 'GPS X좌표 (WGS84 경도 좌표)';
COMMENT ON COLUMN TOUR_DESTINATION.MAPY IS 'GPS Y좌표 (WGS84 위도 좌표)';
COMMENT ON COLUMN TOUR_DESTINATION.MLEVEL IS 'Map Level';
COMMENT ON COLUMN TOUR_DESTINATION.TEL IS '전화번호';
COMMENT ON COLUMN TOUR_DESTINATION.CREATED_TIME IS 'API 응답의 콘텐츠 최초 등록일';
COMMENT ON COLUMN TOUR_DESTINATION.MODIFIED_TIME IS 'API 응답의 콘텐츠 수정일';
COMMENT ON COLUMN TOUR_DESTINATION.FIRST_IMAGE IS '대표이미지(원본) URL';
COMMENT ON COLUMN TOUR_DESTINATION.FIRST_IMAGE2 IS '대표이미지(썸네일) URL';
COMMENT ON COLUMN TOUR_DESTINATION.CPYRHT_DIV_CD IS '저작권 유형';
COMMENT ON COLUMN TOUR_DESTINATION.LDONG_REGN_CD IS '법정동 시도 코드';
COMMENT ON COLUMN TOUR_DESTINATION.LDONG_SIGNGU_CD IS '법정동 시군구 코드';
COMMENT ON COLUMN TOUR_DESTINATION.LCLS_SYSTM1 IS '분류체계 대분류 코드';
COMMENT ON COLUMN TOUR_DESTINATION.LCLS_SYSTM2 IS '분류체계 중분류 코드';
COMMENT ON COLUMN TOUR_DESTINATION.LCLS_SYSTM3 IS '분류체계 소분류 코드';
COMMENT ON COLUMN TOUR_DESTINATION.CREATED_TIME IS '레코드 생성 시간';
COMMENT ON COLUMN TOUR_DESTINATION.MODIFIED_TIME IS '레코드 최종 수정 시간';


--수정시간 자동으로 업데이트 하는 트리거
CREATE OR REPLACE TRIGGER TRG_TOUR_AREA_CODE_MOD
BEFORE UPDATE ON TOUR_AREA_CODE
FOR EACH ROW
BEGIN
    :NEW.LAST_UPDATED_DATE := SYSTIMESTAMP;
END;
/

CREATE OR REPLACE TRIGGER TRG_TOUR_CLASSIFICATION_SYSTEM_CODE_MOD
BEFORE UPDATE ON TOUR_CLASSIFICATION_SYSTEM_CODE
FOR EACH ROW
BEGIN
    :NEW.MODIFIED_TIME := SYSTIMESTAMP;
END;
/

CREATE OR REPLACE TRIGGER TRG_TOUR_DESTINATION_MOD
BEFORE UPDATE ON TOUR_DESTINATION
FOR EACH ROW
BEGIN
    :NEW.MODIFIED_TIME := SYSTIMESTAMP;
END;
/
